{% extends 'base.html' %}
{% load widget_tweaks %}
{% block content %}
{% load static %}


      <article>     
          <h4> {{review.store_name}} </h4>
        　<h1>締め切り時間：{{review.limit_date}}</h1>
        　<h3>集合時刻まで ：<span class="counter"></span></h3>
          <h4>参加状況</h4>
          <br>
               <div class="progress mt-3" style="height: 50px; width:600px; font-size:20px;  "   >
               <label ><progress value={{ review.checked_number }} max={{review.max_number}} style="height: 50px; width:400px; color:orange; font-size:30 ; margin: auto;" >{{ review.checked_number }}人</progress> 
               {{ review.checked_number }}人/{{ review.max_number }}人中</label>
               </div>
      </article>
      
   　　<div class="container">
   　　     <button type="button" class="btn btn-outline-primary mb-12" aria-pressed="true"><a href ="{% url 'reviews:review_update' review.pk %}">更新</a></button>
           <form action="{% url 'reviews:review_detail_cancel' review.pk %}" method="POST">
              {% csrf_token %}
                 <button type="submit" class="btn btn-outline-primary mb-12" data-toggle="modal" data-target="#testModal">キャンセル</button>
            </form>
      </div>
            

<script language="JavaScript">
//オブジェクト取得
const reiwa = document.querySelector('.reiwa');
const counter = document.querySelector('.counter');

//あと何日メソッド
function nanNichi(){

//今の日時
today = new Date();

var year = today.getFullYear();
var month = today.getMonth() + 1;
var day = today.getDate();
var hour = today.getHours();
var min = today.getMinutes();
var sec = today.getSeconds();

//
const tyear = {{review.limit_date.year}};
const tmonth = {{review.limit_date.month}};
const tday = {{review.limit_date.day}};
const thour = {{review.limit_date.hour}} + 9;
const tmin = {{review.limit_date.minute}};
const tsec = {{review.limit_date.second}};

//ターゲット日時


//分、時、日の秒数

var dsec = thour*60*60 + tmin*60 + tsec - (hour*60*60 + min*60 + sec);

const Hour = Math.floor(dsec/(60*60));

var dsec2 = dsec - Hour*60*60;

const Min = Math.floor(dsec2/60);

var dsec3 = dsec2 - Min*60;

const Sec = dsec3;

const Day = tday - day;

//あと何日
const d4_Day = Day;

//あと何時間
const d5_Hour = Hour;

//あと何分
const d6_Minute = Min;

//あと何秒
const d7_Sec = Sec;
   
//カウントダウン
counter.innerHTML = d4_Day+"日"+ d5_Hour + "時間" + d6_Minute + "分" + d7_Sec + "秒";

//1秒ごとに実行
setTimeout(nanNichi, 1000);
}

//関数実行
nanNichi();

</script>

{% endblock %}

